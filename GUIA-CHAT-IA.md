# ğŸ¤– Guia: Chat com IA - NutriBot

## ğŸ¯ O Que Ã© o NutriBot?

NutriBot Ã© seu assistente nutricional pessoal alimentado por IA (Google Gemini 1.5 Flash). Ele conhece seu perfil, suas metas, suas refeiÃ§Ãµes recentes e pode ajudar com:

- ğŸ’¬ Responder dÃºvidas sobre nutriÃ§Ã£o
- ğŸ“Š Analisar suas refeiÃ§Ãµes
- ğŸ’¡ Sugerir melhorias no seu plano alimentar
- ğŸ½ï¸ Recomendar alternativas saudÃ¡veis
- ğŸ“ˆ Avaliar seu progresso
- ğŸ¯ Ajustar suas metas

---

## âœ¨ CaracterÃ­sticas Principais

### ğŸ§  Contexto Inteligente
O NutriBot tem acesso ao seu perfil:
- âœ… Suas metas nutricionais (calorias, macros)
- âœ… Suas refeiÃ§Ãµes de hoje e ontem
- âœ… Seu consumo de Ã¡gua
- âœ… Seus exercÃ­cios
- âœ… Seu objetivo (perder/ganhar/manter peso)
- âœ… Seu saldo calÃ³rico atual

### ğŸ’¬ Conversa Natural
- Responde em portuguÃªs brasileiro
- Usa emojis para facilitar leitura
- MantÃ©m contexto da conversa
- Personaliza respostas baseadas no seu perfil

### ğŸ¯ SugestÃµes Personalizadas
- Perguntassuggeridas baseadas no seu progresso
- Adapta-se ao seu objetivo (perda/ganho de peso)
- Considera seu saldo calÃ³rico do dia

---

## ğŸš€ Como Usar

### 1. Acessar o Chat
**Via Web App:**
```
http://localhost:3001/dashboard/chat
```

**Via WhatsApp:**
O NutriBot tambÃ©m estÃ¡ disponÃ­vel via WhatsApp (veja `GUIA-WHATSAPP-INTEGRADO.md`)

---

### 2. Fazer Perguntas

#### Perguntas Gerais sobre NutriÃ§Ã£o:
```
"O que Ã© Ã­ndice glicÃªmico?"
"Quantas proteÃ­nas devo comer por dia?"
"Carboidratos engordam?"
"Qual a melhor fonte de Ã´mega-3?"
```

#### AnÃ¡lise de RefeiÃ§Ãµes:
```
"Pode analisar minha Ãºltima refeiÃ§Ã£o?"
"O que vocÃª acha do meu cafÃ© da manhÃ£ de hoje?"
"Meu almoÃ§o estava saudÃ¡vel?"
"Comi muito no jantar?"
```

#### SugestÃµes e Alternativas:
```
"O que posso comer para jantar?"
"Preciso de ideias para lanches saudÃ¡veis"
"Como aumentar minha ingestÃ£o de proteÃ­nas?"
"Alternativas saudÃ¡veis para aÃ§Ãºcar"
```

#### AvaliaÃ§Ã£o de Progresso:
```
"Como estÃ¡ meu progresso hoje?"
"Estou no caminho certo?"
"O que preciso melhorar?"
"Vou conseguir bater minha meta?"
```

#### Ajustes e Metas:
```
"Como ajustar minhas metas?"
"Quanto devo comer para perder peso?"
"Estou comendo pouco?"
"Meu saldo calÃ³rico estÃ¡ bom?"
```

---

## ğŸ’¡ Exemplos de Conversas

### Exemplo 1: AnÃ¡lise de RefeiÃ§Ã£o
```
VocÃª: Pode analisar minha Ãºltima refeiÃ§Ã£o?

NutriBot: ğŸ“Š Claro! Vi que vocÃª comeu:
â€¢ Frango grelhado (150g) - 165 kcal
â€¢ Arroz integral (100g) - 123 kcal
â€¢ BrÃ³colis (80g) - 27 kcal

Total: 315 kcal

âœ… AnÃ¡lise: Excelente refeiÃ§Ã£o! EstÃ¡ bem equilibrada:
- âœ… Boa quantidade de proteÃ­nas (35g)
- âœ… Carboidratos complexos
- âœ… Fibras do brÃ³colis
- âš ï¸ Poderia adicionar uma gordura saudÃ¡vel (azeite, abacate)

ğŸ’¡ SugestÃ£o: Na prÃ³xima, adicione 1 colher de azeite (40 kcal) 
para melhorar absorÃ§Ã£o de vitaminas! ğŸ¥‘
```

### Exemplo 2: SugestÃµes de Lanches
```
VocÃª: Preciso de ideias para lanches saudÃ¡veis

NutriBot: ğŸ Aqui vÃ£o algumas opÃ§Ãµes deliciosas e nutritivas:

ğŸ¥œ OpÃ§Ã£o 1 (180 kcal):
â€¢ 30g de castanhas mistas
â€¢ 1 maÃ§Ã£ pequena

ğŸ¥¤ OpÃ§Ã£o 2 (150 kcal):
â€¢ Iogurte grego natural
â€¢ 1 colher de mel
â€¢ Canela a gosto

ğŸ¥‘ OpÃ§Ã£o 3 (200 kcal):
â€¢ 2 torradas integrais
â€¢ 1/4 de abacate amassado
â€¢ Tomate e sal

ğŸŒ OpÃ§Ã£o 4 (160 kcal):
â€¢ 1 banana
â€¢ 2 colheres de pasta de amendoim

Todas se encaixam bem nas suas metas! Qual te interessou mais? ğŸ˜Š
```

### Exemplo 3: AvaliaÃ§Ã£o de Progresso
```
VocÃª: Como estÃ¡ meu progresso hoje?

NutriBot: ğŸ“ˆ Vamos ver como vocÃª estÃ¡ hoje:

ğŸ½ï¸ AlimentaÃ§Ã£o:
â€¢ Consumidas: 1,450 kcal / 2,000 kcal (73%)
â€¢ ProteÃ­nas: 85g / 150g âœ…
â€¢ Carboidratos: 180g / 250g
â€¢ Gorduras: 45g / 65g

ğŸƒ Atividade:
â€¢ 30 min de corrida
â€¢ ~180 kcal queimadas

ğŸ’§ HidrataÃ§Ã£o:
â€¢ 1,500ml / 2,500ml (60%)

âš–ï¸ Saldo: +1,270 kcal

ğŸ’¡ AvaliaÃ§Ã£o: VocÃª estÃ¡ indo bem! Algumas dicas:
âœ… ProteÃ­nas estÃ£o Ã³timas
âš ï¸ Falta beber mais Ã¡gua (1L ainda)
âš ï¸ Ainda pode comer ~550 kcal hoje

Continue assim! ğŸ’ª
```

---

## ğŸ”§ Endpoints da API

### POST /api/chat/message
Envia mensagem e recebe resposta.

**Request:**
```json
{
  "userId": "user123",
  "message": "Como aumentar proteÃ­nas?",
  "conversationId": "conv_123" // opcional
}
```

**Response:**
```json
{
  "success": true,
  "conversationId": "conv_1730678400_abc123",
  "message": "ğŸ¥š Ã“tima pergunta! Aqui estÃ£o as melhores formas...",
  "timestamp": "2025-11-03T..."
}
```

### POST /api/chat/new
Cria nova conversa.

**Request:**
```json
{
  "userId": "user123"
}
```

**Response:**
```json
{
  "success": true,
  "conversationId": "conv_1730678400_xyz789",
  "welcomeMessage": "ğŸ‘‹ OlÃ¡! Sou o NutriBot..."
}
```

### GET /api/chat/suggestions?userId=user123
ObtÃ©m sugestÃµes personalizadas.

**Response:**
```json
{
  "success": true,
  "suggestions": [
    "ğŸ’ª Como posso aumentar minha ingestÃ£o de proteÃ­nas?",
    "ğŸ¥— Quais alimentos sÃ£o bons para perder peso?",
    "ğŸ“Š Como estÃ¡ meu progresso hoje?"
  ]
}
```

### GET /api/chat/history/:conversationId?userId=user123
ObtÃ©m histÃ³rico de conversa.

**Response:**
```json
{
  "success": true,
  "conversationId": "conv_123",
  "history": [
    {
      "role": "user",
      "content": "Como aumentar proteÃ­nas?",
      "timestamp": "2025-11-03T10:00:00Z"
    },
    {
      "role": "assistant",
      "content": "Ã“tima pergunta!...",
      "timestamp": "2025-11-03T10:00:05Z"
    }
  ]
}
```

### GET /api/chat/status
Verifica se o chat estÃ¡ habilitado.

**Response:**
```json
{
  "enabled": true,
  "message": "âœ… Chat com IA estÃ¡ funcionando!"
}
```

---

## ğŸ” Contexto e Privacidade

### O que o NutriBot Sabe:
- âœ… Suas metas configuradas
- âœ… Suas refeiÃ§Ãµes de hoje e ontem
- âœ… Seu consumo de Ã¡gua hoje
- âœ… Seus exercÃ­cios hoje
- âœ… Seu objetivo e peso
- âœ… HistÃ³rico desta conversa

### O que NÃƒO Sabe:
- âŒ Dados de outros usuÃ¡rios
- âŒ Conversas antigas (a menos que solicitado)
- âŒ InformaÃ§Ãµes mÃ©dicas sensÃ­veis
- âŒ Dados nÃ£o relacionados a nutriÃ§Ã£o

### Privacidade:
- Conversas sÃ£o salvas no seu Firestore pessoal
- Apenas vocÃª tem acesso Ã s suas conversas
- Dados nÃ£o sÃ£o compartilhados
- Cache local Ã© limpo automaticamente

---

## ğŸ’¾ Armazenamento

### Cache em MemÃ³ria:
- Conversas recentes ficam em cache
- Acesso mais rÃ¡pido
- Limpa automaticamente apÃ³s inatividade

### Firestore:
- HistÃ³rico completo salvo
- RecuperÃ¡vel a qualquer momento
- Organizado por `conversationId`

**ColeÃ§Ã£o:** `chat_messages`
```javascript
{
  userId: "user123",
  conversationId: "conv_abc",
  messages: [
    { role: "user", content: "...", timestamp: "..." },
    { role: "assistant", content: "...", timestamp: "..." }
  ],
  createdAt: "2025-11-03T..."
}
```

---

## ğŸ¯ Dicas de Uso

### âœ… FaÃ§a:
- Seja especÃ­fico nas perguntas
- Pergunte sobre suas refeiÃ§Ãµes recentes
- PeÃ§a anÃ¡lise do seu progresso
- Use as sugestÃµes fornecidas
- Mantenha conversa natural

### âŒ Evite:
- Perguntas mÃ©dicas complexas
- DiagnÃ³sticos de doenÃ§as
- PrescriÃ§Ãµes de medicamentos
- InformaÃ§Ãµes nÃ£o relacionadas a nutriÃ§Ã£o

---

## ğŸš€ Casos de Uso AvanÃ§ados

### 1. Planejamento de RefeiÃ§Ãµes
```
"Crie um plano de almoÃ§o para a semana que se encaixe 
nas minhas metas de 500 kcal por refeiÃ§Ã£o"
```

### 2. AnÃ¡lise de TendÃªncias
```
"Olhando minhas Ãºltimas refeiÃ§Ãµes, o que vocÃª acha 
que eu preciso melhorar?"
```

### 3. Ajustes de Metas
```
"NÃ£o estou conseguindo comer toda proteÃ­na da meta. 
Como posso ajustar?"
```

### 4. Receitas Personalizadas
```
"Me dÃª uma receita de jantar com frango que tenha 
cerca de 400 kcal"
```

---

## ğŸ› Troubleshooting

### "Chat nÃ£o estÃ¡ respondendo"
```bash
# Verificar status
curl http://localhost:3000/api/chat/status

# Deve retornar: {"enabled": true}
```

### "IA nÃ£o estÃ¡ habilitada"
- Configure `GOOGLE_AI_API_KEY` no `.env`
- Veja: `CONFIGURAR-GOOGLE-AI.md`

### "Respostas estÃ£o lentas"
- Normal: IA processa contexto completo
- MÃ©dia: 2-5 segundos por resposta
- Cache acelera conversas contÃ­nuas

### "Contexto estÃ¡ desatualizado"
- Cache Ã© atualizado automaticamente
- Inicie nova conversa para refresh completo
- Pergunte: "Como estÃ¡ meu progresso hoje?"

---

## ğŸ“± IntegraÃ§Ã£o com WhatsApp

O NutriBot tambÃ©m funciona via WhatsApp! Todas as funcionalidades estÃ£o disponÃ­veis.

Veja: `GUIA-WHATSAPP-INTEGRADO.md`

---

## ğŸ‰ Recursos Futuros

### Em Desenvolvimento:
- [ ] HistÃ³rico de conversas na interface
- [ ] MÃºltiplas conversas simultÃ¢neas
- [ ] AnÃ¡lise de fotos via chat
- [ ] Lembretes via chat
- [ ] Exportar conversas

### Planejado:
- [ ] Voz para texto (Ã¡udio)
- [ ] Texto para voz (resposta falada)
- [ ] Videochamadas com IA
- [ ] IntegraÃ§Ã£o com calendÃ¡rio
- [ ] Compartilhamento de conversas com nutricionista

---

## ğŸ“Š EstatÃ­sticas de Uso

### Performance:
- âš¡ Resposta mÃ©dia: 2-4 segundos
- ğŸ“ Contexto completo em cada mensagem
- ğŸ’¾ HistÃ³rico ilimitado no Firestore
- ğŸ”„ Cache inteligente para rapidez

### Limites:
- ğŸ“¨ Sem limite de mensagens por dia
- â±ï¸ Sem timeout de conversa
- ğŸ’¬ HistÃ³rico completo preservado
- ğŸ” Conversas ilimitadas

---

## ğŸ“ Baseado em CiÃªncia

O NutriBot usa:
- âœ… RecomendaÃ§Ãµes da OMS
- âœ… Diretrizes nutricionais brasileiras
- âœ… Estudos cientÃ­ficos atualizados
- âœ… Boas prÃ¡ticas de nutriÃ§Ã£o

**Sempre menciona que nÃ£o substitui consulta profissional!**

---

## ğŸš€ EstÃ¡ Pronto para Usar!

Acesse agora:
```
http://localhost:3001/dashboard/chat
```

Ou teste via API:
```bash
curl -X POST http://localhost:3000/api/chat/message \
  -H "Content-Type: application/json" \
  -d '{"userId":"user123","message":"OlÃ¡!"}'
```

---

**Criado com â¤ï¸ e Google Gemini 1.5 Flash**

